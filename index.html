<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>小米Bootloader开放倡议 | 联合签名平台</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --mi-orange: #ff6900;
            --mi-orange-dark: #e55d00;
            --mi-orange-light: #ff8c42;
            --mi-blue: #00c3ff;
            --mi-gray: #f8f9fa;
            --dark-bg: #0a0a0f;
            --card-bg: rgba(255, 255, 255, 0.2);
            --text-primary: #333333;
            --text-secondary: #666666;
            --success: #4caf50;
            --warning: #ff9800;
            --error: #f44336;
            --glass-border: rgba(255, 255, 255, 0.3);
            --glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.2);
            /* 新增颜色变量用于UI优化 */
            --mi-orange-accent: #ff6900;
            --success-color: #4caf50;
            --error-color: #f44336;
            --warning-color: #ff9800;
            --info-color: #2196f3;
            --card-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            --hover-shadow: 0 6px 24px rgba(0, 0, 0, 0.12);
            --transition: all 0.3s ease;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #e0eafc, #cfdef3, #dfe9f3);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* 小米橙色主题元素 */
        .mi-orange-accent {
            color: var(--mi-orange);
        }

        .mi-orange-bg {
            background: var(--mi-orange);
        }

        .mi-orange-gradient {
            background: linear-gradient(45deg, var(--mi-orange), var(--mi-orange-light));
        }

        .mi-orange-border {
            border-color: var(--mi-orange) !important;
        }

        /* 毛玻璃效果 */
        .glass-effect {
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            box-shadow: var(--glass-shadow);
        }

        /* 导航栏 */
        .navbar {
            padding: 1rem 3%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.3);
            border-bottom: 1px solid var(--glass-border);
            height: 60px;
            box-shadow: var(--card-shadow);
            transition: var(--transition);
        }

        .navbar.scrolled {
            background: rgba(255, 255, 255, 0.8);
            box-shadow: var(--hover-shadow);
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(45deg, var(--mi-orange), var(--mi-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            white-space: nowrap;
            transition: var(--transition);
        }

        .logo i {
            color: var(--mi-orange);
            margin-right: 0.5rem;
            transition: var(--transition);
        }

        .nav-toggle {
            display: none;
            font-size: 1.5rem;
            background: none;
            border: none;
            color: var(--text-primary);
            cursor: pointer;
            transition: var(--transition);
            border-radius: 8px;
            padding: 0.5rem;
        }

        .nav-toggle:hover {
            background: rgba(255, 123, 46, 0.1);
            color: var(--mi-orange);
        }

        .nav-links {
            display: flex;
            gap: 1.5rem;
        }

        .nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            padding: 0.5rem 1rem;
            border-radius: 10px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-links a:hover {
            color: var(--mi-orange);
            background: rgba(255, 123, 46, 0.1);
            transform: translateY(-2px);
        }

        .nav-links a.active {
            color: var(--mi-orange);
            background: rgba(255, 123, 46, 0.15);
        }

        /* 移动端导航菜单 */
        .mobile-menu {
            position: fixed;
            top: 60px;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--glass-border);
            padding: 1rem 3%;
            transform: translateY(-100%);
            transition: transform 0.3s ease;
            z-index: 999;
        }

        .mobile-menu.active {
            transform: translateY(0);
        }

        .mobile-menu .nav-links {
            flex-direction: column;
            gap: 0.5rem;
        }

        .mobile-menu .nav-links a {
            padding: 1rem;
            border-radius: 12px;
            justify-content: center;
        }
        .mobile-menu .nav-links a:hover {
            color: var(--mi-orange);
            background: rgba(255, 123, 46, 0.1);
        }

        .mobile-menu .nav-links a.active {
            color: var(--mi-orange);
            background: rgba(255, 123, 46, 0.15);
        }

        /* 主要内容区域 */
        .main-content {
            padding: 80px 3% 30px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .hero-section {
            text-align: center;
            margin-bottom: 2rem;
            padding: 3rem 1rem;
            animation: fadeInUp 0.8s ease forwards;
        }

        .hero-title {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 1.5rem;
            background: linear-gradient(45deg, var(--mi-orange), var(--mi-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.3;
            text-align: center;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .hero-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            max-width: 700px;
            margin: 0 auto 2rem;
            line-height: 1.7;
        }

        /* 统计卡片 */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            padding: 1.8rem 1.5rem;
            text-align: center;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 16px;
            box-shadow: var(--card-shadow);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 123, 46, 0.1), transparent);
            transition: left 0.5s;
        }

        .stat-card:hover::before {
            left: 100%;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--hover-shadow);
        }

        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: var(--mi-orange);
            transition: transform 0.3s ease;
        }

        .stat-card:hover .stat-icon {
            transform: scale(1.1);
        }

        .stat-number {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            background: linear-gradient(45deg, var(--mi-orange), var(--mi-orange-light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            font-size: 1rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        /* 签名按钮 */
        .signature-button-container {
            text-align: center;
            margin: 2rem 0;
        }

        .signature-btn {
            background: linear-gradient(45deg, var(--mi-orange), var(--mi-orange-dark));
            color: white;
            border: none;
            padding: 1.2rem 2.5rem;
            font-size: 1.2rem;
            font-weight: 600;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 25px rgba(255, 123, 46, 0.3);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
            min-height: 56px;
            margin: 0.5rem;
        }

        .signature-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(255, 123, 46, 0.4);
        }

        .signature-btn:active {
            transform: translateY(-1px);
        }

        /* 签名模态框 */
        .signature-modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }

        .signature-modal-content {
            background: linear-gradient(135deg, #ffffff, #f8f9fa);
            margin: 5% auto;
            padding: 2rem;
            border-radius: 20px;
            width: 95%;
            max-width: 700px;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid var(--glass-border);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
            position: relative;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--glass-border);
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--mi-orange);
            margin: 0;
        }

        .close-modal {
            color: var(--text-secondary);
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
            background: none;
            border: none;
            padding: 0;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .close-modal:hover {
            color: var(--mi-orange);
            background: rgba(255, 123, 46, 0.1);
        }

        /* 签名表单 */
        .signature-section {
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 1.8rem;
            font-weight: 800;
            margin-bottom: 1.5rem;
            text-align: center;
            position: relative;
            color: var(--text-primary);
            background: linear-gradient(45deg, var(--mi-orange), var(--mi-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .section-title::after {
            content: '';
            display: block;
            width: 50px;
            height: 4px;
            background: var(--mi-orange);
            margin: 0.5rem auto;
            border-radius: 3px;
        }

        .form-container {
            padding: 2rem;
            border-radius: 16px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .form-group {
            margin-bottom: 1.2rem;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        label {
            display: block;
            margin-bottom: 0.6rem;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 1rem;
        }

        input, textarea {
            width: 100%;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.4);
            border: 2px solid var(--glass-border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        input:focus, textarea:focus {
            outline: none;
            border-color: var(--mi-orange);
            background: rgba(255, 255, 255, 0.6);
            box-shadow: 0 0 0 4px rgba(255, 123, 46, 0.3);
        }

        input::placeholder, textarea::placeholder {
            color: var(--text-secondary);
            font-size: 1rem;
        }

        /* 设备支持列表 */
        .device-list {
            background: rgba(255, 255, 255, 0.25);
            border-radius: 16px;
            padding: 1.2rem;
            margin: 1.2rem 0;
            border: 1px solid var(--glass-border);
            max-height: 220px;
            overflow-y: auto;
            box-shadow: var(--inner-shadow);
        }

        .device-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem;
            margin: 0.5rem 0;
            background: rgba(255, 255, 255, 0.4);
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .device-item:hover {
            background: rgba(255, 255, 255, 0.6);
            transform: translateX(5px);
        }

        .device-name {
            font-size: 1rem;
            color: var(--text-primary);
            font-weight: 500;
        }

        .remove-device {
            background: rgba(244, 67, 54, 0.2);
            color: #f44336;
            border: none;
            padding: 0.4rem 0.8rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .remove-device:hover {
            background: rgba(244, 67, 54, 0.3);
            transform: scale(1.05);
        }

        .add-device-btn {
            background: rgba(255, 255, 255, 0.3);
            color: var(--text-primary);
            border: 1px solid var(--glass-border);
            padding: 0.8rem 1.2rem;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.6rem;
            margin-top: 0.8rem;
        }

        .add-device-btn:hover {
            background: rgba(255, 255, 255, 0.5);
            border-color: var(--mi-orange);
            transform: translateY(-2px);
            box-shadow: var(--hover-shadow);
        }

        .add-device-btn i {
            font-size: 1.2rem;
        }

        /* 签名板 */
        .signature-pad-container {
            background: rgba(0, 0, 0, 0.25);
            border-radius: 16px;
            padding: 1.2rem;
            margin: 1rem 0;
            border: 1px solid var(--glass-border);
            box-shadow: var(--inner-shadow);
        }

        .signature-pad-wrapper {
            position: relative;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .signature-pad {
            cursor: crosshair;
            display: block;
            width: 100%;
            height: 180px;
            touch-action: none;
        }

        .signature-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-top: 1.2rem;
            align-items: center;
            justify-content: center;
        }

        .color-palette {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            margin-right: 0.8rem;
        }

        .color-palette span {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-right: 0.5rem;
            font-weight: 500;
        }

        .color-option {
            width: 26px;
            height: 26px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .color-option.active {
            border-color: white;
            transform: scale(1.2);
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.2);
        }

        .color-option:hover {
            transform: scale(1.1);
        }

        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
            min-height: 48px;
            min-width: 48px;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--mi-orange), var(--mi-orange-dark));
            color: white;
            flex: 1;
            min-width: 140px;
            box-shadow: 0 6px 20px rgba(255, 123, 46, 0.4);
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.6s;
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        .btn-primary:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(255, 123, 46, 0.5);
        }

        .btn-primary:active {
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.3);
            color: var(--text-primary);
            border: 1px solid var(--glass-border);
            min-width: 100px;
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.4);
            border-color: var(--mi-orange);
        }

        /* 消息提示 */
        .message {
            padding: 1rem 1.2rem;
            border-radius: 12px;
            margin: 1rem 0;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-size: 1rem;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            box-shadow: var(--card-shadow);
            transform: translateY(0);
            transition: all 0.3s ease;
        }

        .message.show {
            transform: translateY(0);
            opacity: 1;
        }

        .message i {
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .message.success {
            background: rgba(76, 175, 80, 0.25);
            border: 1px solid rgba(76, 175, 80, 0.4);
            color: #4caf50;
        }

        .message.error {
            background: rgba(244, 67, 54, 0.25);
            border: 1px solid rgba(244, 67, 54, 0.4);
            color: #f44336;
        }

        .message.info {
            background: rgba(33, 150, 243, 0.25);
            border: 1px solid rgba(33, 150, 243, 0.4);
            color: #2196f3;
        }

        /* 防刷提示 */
        .cooldown-message {
            background: rgba(255, 152, 0, 0.2);
            border: 1px solid rgba(255, 152, 0, 0.3);
            color: #ff9800;
            padding: 1rem;
            border-radius: 12px;
            margin: 1rem 0;
            text-align: center;
        }
        
        .cooldown-timer {
            font-weight: bold;
            color: var(--mi-orange);
        }

        /* 签名列表页面 */
        .signatures-page {
            padding: 80px 3% 30px;
            max-width: 1200px;
            margin: 0 auto;
            display: none;
        }

        .page-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .page-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--mi-orange);
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            margin: 2rem 0;
            flex-wrap: wrap;
        }

        .pagination-btn {
            background: rgba(255, 255, 255, 0.3);
            color: var(--text-primary);
            border: 1px solid var(--glass-border);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pagination-btn:hover {
            background: rgba(255, 255, 255, 0.4);
            border-color: var(--mi-orange);
        }

        .pagination-btn.active {
            background: linear-gradient(45deg, var(--mi-orange), var(--mi-orange-dark));
            border-color: var(--mi-orange);
        }

        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .page-info {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .back-to-home {
            text-align: center;
            margin: 2rem 0;
        }

        .back-btn {
            background: rgba(255, 255, 255, 0.3);
            color: var(--text-primary);
            border: 1px solid var(--glass-border);
            padding: 0.8rem 2rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            font-weight: 500;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.4);
            border-color: var(--mi-orange);
        }

        /* 签名列表 */
        .signatures-section {
            margin-bottom: 2rem;
        }

        .signatures-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1rem;
        }

        .signature-card {
            padding: 1.2rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .signature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--mi-orange);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .signature-card:hover::before {
            transform: scaleX(1);
        }

        .signature-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        .signature-name {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.3rem;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        .signature-date {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        .signature-devices {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 0.8rem;
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            border-left: 3px solid var(--mi-orange);
        }

        .device-tag {
            display: inline-block;
            background: rgba(255, 123, 46, 0.2);
            color: var(--mi-orange);
            padding: 0.2rem 0.5rem;
            border-radius: 12px;
            margin: 0.2rem;
            font-size: 0.7rem;
        }

        .signature-image {
            max-width: 100%;
            height: auto;
            max-height: 100px;
            object-fit: contain;
            background: white;
            border-radius: 6px;
            padding: 5px;
            border: 1px solid var(--glass-border);
            margin-top: 0.5rem;
        }

        /* 加载状态 */
        .loading {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
            font-size: 1rem;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            background: rgba(0, 0, 0, 0.1);
            border-radius: 16px;
            margin: 1rem;
        }

        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.2);
            border-top: 4px solid var(--mi-orange);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1.2s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite;
            margin: 0 auto 1rem;
            box-shadow: 0 0 20px rgba(255, 111, 0, 0.3);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* 页脚 */
        .footer {
            text-align: center;
            padding: 2.5rem 3%;
            color: var(--text-secondary);
            border-top: 1px solid var(--glass-border);
            margin-top: 2rem;
            font-size: 1rem;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            background: rgba(0, 0, 0, 0.15);
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin: 1.5rem 0;
            flex-wrap: wrap;
        }

        .footer-links a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.95rem;
            padding: 0.5rem 1rem;
            border-radius: 20px;
        }

        .footer-links a:hover {
            color: var(--mi-orange);
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        /* GitHub项目信息 */
        .github-info {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 16px;
            padding: 1.2rem;
            margin: 1.2rem 0;
            border: 1px solid var(--glass-border);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: var(--inner-shadow);
            transition: all 0.3s ease;
        }

        .github-info:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-3px);
            box-shadow: var(--card-shadow);
        }

        .github-info a {
            color: var(--mi-blue);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.6rem;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .github-info a:hover {
            color: var(--mi-orange);
            transform: translateX(5px);
        }

        /* 小米品牌元素 */
        .mi-branding {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            margin: 1.8rem 0;
            padding: 1rem;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            background: rgba(0, 0, 0, 0.1);
            border-radius: 20px;
            border: 1px solid var(--glass-border);
        }

        .mi-logo {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--mi-orange);
            text-shadow: 0 0 15px rgba(255, 111, 0, 0.4);
        }

        .mi-tagline {
            color: var(--text-secondary);
            font-style: italic;
            font-size: 1rem;
            text-align: center;
            margin-left: 0.5rem;
            font-weight: 300;
        }

        /* 背景装饰 */
        .mi-decoration {
            position: fixed;
            opacity: 0.15;
            z-index: -1;
            pointer-events: none;
            animation: float 15s ease-in-out infinite;
        }

        .mi-circle {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: var(--mi-orange);
            filter: blur(50px);
            animation: pulse 8s ease-in-out infinite;
        }

        .mi-circle-1 {
            top: 10%;
            left: 5%;
        }

        .mi-circle-2 {
            bottom: 15%;
            right: 5%;
            background: var(--mi-blue);
            animation-delay: 2s;
        }

        @keyframes float {
            0% { transform: translateY(0) translateX(0); }
            50% { transform: translateY(-20px) translateX(10px); }
            100% { transform: translateY(0) translateX(0); }
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 0.15; }
            50% { transform: scale(1.1); opacity: 0.25; }
            100% { transform: scale(1); opacity: 0.15; }
        }

        /* 隐私政策模态框 */
        .privacy-modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
        }

        .privacy-modal.active {
            display: flex;
        }

        .privacy-modal-content {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border-radius: 24px;
            width: 100%;
            max-width: 650px;
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--glass-border);
            transform: translateY(20px) scale(0.95);
            opacity: 0;
            transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            max-height: 85vh;
            overflow-y: auto;
        }

        .privacy-modal.active .privacy-modal-content {
            transform: translateY(0) scale(1);
            opacity: 1;
        }

        .privacy-modal-header {
            padding: 1.8rem 1.8rem 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .privacy-modal-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--text-primary);
            margin: 0;
            background: linear-gradient(45deg, var(--mi-orange), var(--mi-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .privacy-close {
            background: none;
            border: none;
            font-size: 1.8rem;
            cursor: pointer;
            color: var(--text-secondary);
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .privacy-close:hover {
            color: var(--mi-orange);
            background: rgba(255, 123, 46, 0.15);
            transform: rotate(90deg);
        }

        .privacy-modal-body {
            line-height: 1.8;
        }

        .privacy-modal-body h3 {
            color: var(--mi-orange);
            margin: 1.5rem 0 1rem 0;
            font-size: 1.2rem;
        }

        .privacy-modal-body p {
            margin-bottom: 1rem;
            color: var(--text-secondary);
        }

        .privacy-modal-body ul {
            margin: 1rem 0;
            padding-left: 1.5rem;
        }

        .privacy-modal-body li {
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
        }

        /* 支持话语详情模态框 */
        .support-message-modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
        }

        .support-message-modal.active {
            display: flex;
        }

        .support-message-modal-content {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border-radius: 24px;
            width: 100%;
            max-width: 650px;
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--glass-border);
            transform: translateY(20px) scale(0.95);
            opacity: 0;
            transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            max-height: 85vh;
            overflow-y: auto;
        }

        .support-message-modal.active .support-message-modal-content {
            transform: translateY(0) scale(1);
            opacity: 1;
        }

        .support-message-modal-header {
            padding: 1.8rem 1.8rem 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .support-message-modal-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--text-primary);
            margin: 0;
            background: linear-gradient(45deg, var(--mi-orange), var(--mi-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .support-message-close {
            background: none;
            border: none;
            font-size: 1.8rem;
            cursor: pointer;
            color: var(--text-secondary);
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .support-message-close:hover {
            color: var(--mi-orange);
            background: rgba(255, 123, 46, 0.15);
            transform: rotate(90deg);
        }

        .support-message-modal-body {
            padding: 1.8rem;
            line-height: 1.8;
        }

        .support-message-content {
            color: var(--text-secondary);
            white-space: pre-wrap;
            word-wrap: break-word;
            font-size: 1.1rem;
        }

        /* 动画效果 */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in {
            animation: fadeInUp 0.6s ease forwards;
        }

        .delay-1 {
            animation-delay: 0.1s;
        }

        .delay-2 {
            animation-delay: 0.2s;
        }

        .delay-3 {
            animation-delay: 0.3s;
        }

        /* 响应式设计 */
        @media (min-width: 768px) {
            .hero-title {
                font-size: 2.8rem;
            }
            
            .hero-subtitle {
                font-size: 1.2rem;
                max-width: 700px;
                margin-left: auto;
                margin-right: auto;
            }
            
            .form-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .nav-toggle {
                display: none;
            }
            
            .mobile-menu {
                display: none;
            }
            
            .main-content {
                padding: 90px 5% 40px;
            }
            
            .form-container {
                padding: 2rem;
            }
            
            .signature-pad {
                height: 200px;
            }
            
            .signature-controls {
                flex-wrap: nowrap;
            }
            
            .btn {
                padding: 1rem 2rem;
                font-size: 1.1rem;
            }
            
            .stat-number {
                font-size: 2.5rem;
            }
            
            .section-title {
                font-size: 2rem;
            }
            
            .page-title {
                font-size: 2.5rem;
            }
        }

        @media (min-width: 1024px) {
            .hero-title {
                font-size: 3.2rem;
            }
            
            .hero-subtitle {
                font-size: 1.3rem;
            }
            
            .stats-container {
                gap: 1.5rem;
            }
            
            .stat-card {
                padding: 2rem;
            }
            
            .stat-icon {
                font-size: 2.5rem;
            }
            
            .stat-number {
                font-size: 3rem;
            }
            
            .signature-pad {
                height: 200px;
            }
        }

        /* 触摸设备优化 */
        @media (hover: none) and (pointer: coarse) {
            .nav-links a:hover {
                color: var(--text-secondary);
                background: transparent;
            }
            
            .stat-card:hover {
                transform: none;
            }
            
            .signature-card:hover::before {
                transform: scaleX(0);
            }
            
            .signature-card:hover {
                transform: none;
                box-shadow: none;
            }
            
            .signature-card:hover::before {
                transform: scaleX(0);
            }
        }

        /* 高对比度模式支持 */
        @media (prefers-contrast: high) {
            .glass-effect {
                border: 2px solid black;
                background: rgba(255, 255, 255, 0.8);
            }
            
            .signature-btn, .btn-primary {
                border: 2px solid var(--mi-orange);
            }
        }

        /* 减少动画模式支持 */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
            
            .signature-pad {
                cursor: pointer;
            }
        }
    </style>
</head>
<body>
    <!-- 背景装饰元素 -->
    <div class="mi-decoration mi-circle mi-circle-1"></div>
    <div class="mi-decoration mi-circle mi-circle-2"></div>

    <!-- 导航栏 -->
    <nav class="navbar glass-effect" role="navigation" aria-label="主导航">
        <div class="logo">
            <i class="fas fa-mobile-alt"></i> MI Bootloader
        </div>
        <button class="nav-toggle" id="navToggle" aria-label="切换移动端菜单" aria-expanded="false">
            <i class="fas fa-bars"></i>
        </button>
        <div class="nav-links">
            <a href="#" id="homeLink"><i class="fas fa-home"></i> 首页</a>
            <a href="#" id="signaturesLink"><i class="fas fa-users"></i> 签名列表</a>
        </div>
    </nav>

    <!-- 移动端菜单 -->
    <div class="mobile-menu" id="mobileMenu" role="navigation" aria-label="移动端导航">
        <div class="nav-links">
            <a href="#" id="mobileHomeLink"><i class="fas fa-home"></i> 首页</a>
            <a href="#" id="mobileSignaturesLink"><i class="fas fa-users"></i> 签名列表</a>
        </div>
    </div>

    <!-- 主要内容 -->
    <main class="main-content" id="homePage">
        <!-- 英雄区域 -->
    <section id="home" class="hero-section animate-fade-in">
        <h1 class="hero-title">呼吁小米全面开放Bootloader解锁</h1>
        <p class="hero-subtitle">
            我们相信开源精神和用户自由是科技发展的基石。让我们一起为小米设备的完全控制权发声，
            要求小米官方全面开放Bootloader解锁权限，保障用户的合法权益。
        </p>
        <div class="glass-effect" style="display: inline-block; padding: 0.8rem 1.5rem; margin-top: 1rem;">
            <i class="fas fa-bullhorn mi-orange-accent"></i> 加入我们，为开源发声！
        </div>
            
            <!-- 签名按钮 -->
            <div class="signature-button-container">
                <button class="signature-btn" id="openSignatureModal">
                    <i class="fas fa-file-signature"></i> 立即签名支持
                </button>
                <button class="signature-btn" id="viewSignaturesBtn">
                    <i class="fas fa-users"></i> 查看所有签名
                </button>
            </div>
            
            <!-- 小米品牌元素 -->
            <div class="mi-branding">
                <div class="mi-logo">MI</div>
                <div class="mi-tagline">"让每个人都能享受科技的乐趣"</div>
            </div>
        </section>

        <!-- 统计卡片 -->
        <section class="stats-container" tabindex="0" role="region" aria-label="统计信息">
            <div class="stat-card glass-effect animate-fade-in delay-1">
                <div class="stat-icon">
                    <i class="fas fa-users"></i>
                </div>
                <div class="stat-number" id="signatureCount">0</div>
                <div class="stat-label">已签名支持者</div>
            </div>
            <div class="stat-card glass-effect animate-fade-in delay-2">
                <div class="stat-icon">
                    <i class="fas fa-mobile-alt"></i>
                </div>
                <div class="stat-number" id="supportCount">0</div>
                <div class="stat-label">支持的设备</div>
            </div>
            <div class="stat-card glass-effect animate-fade-in delay-3">
                <div class="stat-icon">
                    <i class="fas fa-calendar-alt"></i>
                </div>
                <div class="stat-number" id="daysCount">0</div>
                <div class="stat-label">倡议天数</div>
            </div>
        </section>
        
        <!-- 调试按钮 -->
        <div style="text-align: center; margin: 20px 0;">
            <!-- 调试按钮已移除 -->
        </div>
    </main>

    <!-- 签名列表页面 -->
    <div class="signatures-page" id="signaturesPage">
        <div class="page-header" tabindex="-1">
            <h1 class="page-title">签名支持者列表</h1>
            <p class="hero-subtitle">以下是支持小米Bootloader开放倡议的签名者</p>
        </div>

        <div class="signatures-section">
            <div id="signaturesPageContainer" class="signatures-grid">
                <div class="loading">
                    <div class="spinner"></div>
                    正在加载签名列表...
                </div>
            </div>
        </div>

        <!-- 分页控件 -->
        <div class="pagination" id="pagination">
            <button class="pagination-btn" id="prevPage" disabled>
                <i class="fas fa-arrow-left"></i> 上一页
            </button>
            <span class="page-info" id="pageInfo">第 1 页，共 1 页</span>
            <button class="pagination-btn" id="nextPage" disabled>
                下一页 <i class="fas fa-arrow-right"></i>
            </button>
        </div>

        <div class="back-to-home">
            <button class="back-btn" id="backToHome">
                <i class="fas fa-arrow-left"></i> 返回首页
            </button>
        </div>
    </div>

    <!-- 签名模态框 -->
    <div id="signatureModal" class="signature-modal" role="dialog" aria-labelledby="modalTitle" aria-modal="true" tabindex="-1">
        <div class="signature-modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">添加签名支持</h2>
                <button class="close-modal" id="closeSignatureModal" aria-label="关闭">&times;</button>
            </div>
            <div class="signature-section">
                <div class="form-container glass-effect">
                    <div class="form-grid">
                        <div class="form-group">
                        <label for="name"><i class="fas fa-user mi-orange-accent"></i> 姓名 *</label>
                        <input type="text" id="name" placeholder="请输入您的真实姓名" required aria-describedby="nameHelp">
                        <small id="nameHelp">请输入您的真实姓名，这将显示在签名列表中</small>
                    </div>
                    <div class="form-group">
                        <label for="email"><i class="fas fa-envelope mi-orange-accent"></i> 邮箱 (可选)</label>
                        <input type="email" id="email" placeholder="请输入您的邮箱地址" aria-describedby="emailHelp">
                        <small id="emailHelp">请输入您的有效邮箱地址，仅用于联系，不会公开显示</small>
                    </div>
                    </div>
                    
                    <div class="form-group full-width">
                        <label for="deviceName"><i class="fas fa-mobile-alt mi-orange-accent"></i> 支持的设备 *</label>
                        <input type="text" id="deviceName" placeholder="请输入设备全名，例如：小米13、Redmi Note 12等（仅限小米设备）" aria-describedby="deviceHelp">
                        <button type="button" class="add-device-btn" id="addDeviceBtn">
                            <i class="fas fa-plus"></i> 添加设备
                        </button>
                        <div class="device-list" id="deviceList">
                            <div style="text-align: center; color: var(--text-secondary); padding: 1rem;">
                                请添加您支持的设备
                            </div>
                        </div>
                        <small id="deviceHelp">请添加您用于支持的小米设备全名，每台设备请单独添加</small>
                    </div>
                    
                    <div class="form-group full-width">
                        <label for="supportMessage"><i class="fas fa-comment mi-orange-accent"></i> 支持话语 (可选，10000字以内)</label>
                        <textarea id="supportMessage" placeholder="请输入您的支持话语，最多10000字" rows="4" maxlength="10000" aria-describedby="messageHelp"></textarea>
                        <small id="messageHelp">您可以在这里添加您的支持话语，表达您对小米BL解锁的支持和看法</small>
                    </div>

                    <div class="form-group full-width">
                        <label for="signatureCanvas"><i class="fas fa-signature mi-orange-accent"></i> 电子签名 *</label>
                        <div class="signature-pad-container">
                            <div class="signature-pad-wrapper">
                                <canvas id="signatureCanvas" class="signature-pad" aria-label="电子签名区域" tabindex="0" role="application"></canvas>
                            </div>
                        </div>
                        <div class="signature-controls">
                            <div class="color-palette" role="radiogroup" aria-label="选择画笔颜色">
                                <span><i class="fas fa-palette"></i></span>
                                <div class="color-option active" style="background: #000000;" data-color="#000000" tabindex="0" role="radio" aria-checked="true"></div>
                                <div class="color-option" style="background: var(--mi-orange);" data-color="#ff6900" tabindex="0" role="radio" aria-checked="false"></div>
                                <div class="color-option" style="background: var(--mi-blue);" data-color="#00c3ff" tabindex="0" role="radio" aria-checked="false"></div>
                                <div class="color-option" style="background: #4caf50;" data-color="#4caf50" tabindex="0" role="radio" aria-checked="false"></div>
                            </div>
                            <button type="button" class="btn btn-secondary" id="clearSignatureBtn">
                                <i class="fas fa-eraser"></i> 清除
                            </button>
                        </div>
                        <small>请在上方区域绘制您的电子签名，支持鼠标或触摸屏操作。键盘用户请使用Tab键聚焦到签名区域，然后使用方向键绘制签名，空格键开始/停止绘制。</small>
                    </div>

                    <div id="signatureMessage"></div>
                    
                    <button class="btn btn-primary" id="submitSignatureBtn">
                        <i class="fas fa-paper-plane"></i> 提交签名
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 页脚 -->
    <footer class="footer">
        <div class="footer-links">
            <a href="https://github.com/ziyi127/xiaomi-bl-petition" target="_blank"><i class="fab fa-github"></i> GitHub项目</a>
            <a href="#" id="privacyPolicyLink"><i class="fas fa-shield-alt"></i> 隐私政策</a>
            <a href="https://github.com/ziyi127" target="_blank"><i class="fab fa-github"></i> 开发者主页</a>
        </div>
        <p>&copy; 2025 小米Bootloader开放倡议. 保留所有权利.</p>
        <p style="font-size: 0.8rem; margin-top: 0.8rem;">
            所有签名数据均已优化并安全存储在GitHub Issues中，确保透明度和安全性
        </p>
    </footer>

    <!-- 支持话语详情模态框 -->
    <div id="supportMessageModal" class="support-message-modal" role="dialog" aria-labelledby="supportMessageModalTitle" aria-modal="true" tabindex="-1">
        <div class="support-message-modal-content">
            <div class="support-message-modal-header">
                <h2 class="support-message-modal-title" id="supportMessageModalTitle">支持话语详情</h2>
                <button class="support-message-close" id="closeSupportMessageModal" aria-label="关闭">&times;</button>
            </div>
            <div class="support-message-modal-body">
                <div class="support-message-content" id="supportMessageContent"></div>
            </div>
        </div>
    </div>

    <!-- 隐私政策模态框 -->
    <div id="privacyModal" class="privacy-modal" role="dialog" aria-labelledby="privacyModalTitle" aria-modal="true" tabindex="-1">
        <div class="privacy-modal-content">
            <div class="privacy-modal-header">
                <h2 class="privacy-modal-title" id="privacyModalTitle">隐私政策</h2>
                <button class="privacy-close" id="closePrivacyModal" aria-label="关闭">&times;</button>
            </div>
            <div class="privacy-modal-body">
                <h3>隐私政策概述</h3>
                <p>欢迎使用小米Bootloader开放倡议签名平台。我们重视您的隐私保护，并致力于透明地处理您的个人信息。</p>

                <h3>信息收集</h3>
                <p>当您使用本签名平台时，我们可能会收集以下信息：</p>
                <ul>
                    <li><strong>姓名</strong>：您提供的真实姓名（必填，将显示在签名列表中）</li>
                    <li><strong>邮箱地址</strong>：您提供的邮箱地址（可选，仅用于联系，不会公开显示）</li>
                    <li><strong>设备信息</strong>：您支持的小米设备名称</li>
                    <li><strong>电子签名</strong>：您绘制的电子签名图像</li>
                    <li><strong>时间戳</strong>：签名提交的具体时间</li>
                    <li><strong>技术信息</strong>：浏览器类型、访问时间等基本技术信息</li>
                </ul>

                <h3>信息使用</h3>
                <p>我们收集的信息仅用于以下合法目的：</p>
                <ul>
                    <li>在签名支持者列表中展示您的支持</li>
                    <li>统计签名人数和支持设备数量</li>
                    <li>维护和改进平台功能</li>
                    <li>倡议活动的正当用途</li>
                    <li>防止恶意刷签名行为</li>
                </ul>
                <p>我们不会将您的个人信息用于任何其他目的，也不会与任何第三方分享您的个人信息，除非获得您的明确同意或法律要求。</p>

                <h3>数据存储与安全</h3>
                <p>您的数据将得到安全保护：</p>
                <ul>
                    <li><strong>存储位置</strong>：签名数据通过GitHub API安全地存储在GitHub Issues中</li>
                    <li><strong>本地存储</strong>：防刷时间戳存储在您的浏览器本地存储中</li>
                    <li><strong>传输安全</strong>：所有数据传输使用HTTPS加密</li>
                    <li><strong>访问控制</strong>：只有项目维护者可以访问原始数据</li>
                    <li><strong>数据保留</strong>：签名数据将长期保留用于倡议活动</li>
                </ul>
                <p>尽管我们采取了合理的安全措施，但没有任何传输方法或电子存储方法是100%安全的。因此，我们无法保证信息的绝对安全。</p>

                <h3>数据共享与披露</h3>
                <p>我们承诺不会：</p>
                <ul>
                    <li>将您的个人信息出售给第三方</li>
                    <li>未经您同意分享您的邮箱地址</li>
                    <li>将数据用于商业目的</li>
                    <li>向政府机构披露数据，除非法律要求</li>
                </ul>
                <p>我们可能会在以下情况下披露您的信息：</p>
                <ul>
                    <li>根据法律法规的要求</li>
                    <li>为了保护平台、用户或公众的权利和财产</li>
                    <li>在涉及合并、收购或资产出售的情况下</li>
                    <li>在签名列表中公开显示您的支持信息</li>
                </ul>
                <p>您的签名数据将被公开显示在签名列表中，但您的邮箱地址不会被公开。</p>

                <h3>您的权利</h3>
                <p>根据隐私保护法规，您拥有以下权利：</p>
                <ul>
                    <li><strong>访问权</strong>：可以查看您的签名信息</li>
                    <li><strong>删除权</strong>：可以通过联系开发者删除您的签名</li>
                    <li><strong>反对权</strong>：可以反对数据的特定使用方式</li>
                    <li><strong>数据可携权</strong>：可以获取您的数据副本</li>
                    <li><strong>申诉权</strong>：可以向相关监管机构申诉</li>
                </ul>
                <p>如需行使这些权利，请通过本政策末尾提供的联系方式与我们联系。</p>

                <h3>Cookie和追踪技术</h3>
                <p>本平台使用的技术：</p>
                <ul>
                    <li><strong>本地存储</strong>：使用浏览器localStorage存储防刷时间戳</li>
                    <li><strong>无追踪Cookie</strong>：不使用追踪性Cookie</li>
                    <li><strong>无分析工具</strong>：不使用Google Analytics等分析工具</li>
                    <li><strong>无广告网络</strong>：不集成任何广告网络</li>
                </ul>
                <p>我们的网站不使用Cookie或其他追踪技术来收集您的个人信息。</p>

                <h3>第三方服务</h3>
                <p>本平台集成的第三方服务：</p>
                <ul>
                    <li><strong>GitHub</strong>：用于存储签名数据和托管网站</li>
                    <li><strong>Font Awesome</strong>：用于图标显示（CDN加载）</li>
                    <li><strong>无其他第三方服务</strong>：不集成社交媒体按钮或其他追踪服务</li>
                </ul>
                <p>GitHub可能有其自己的隐私政策，我们建议您在使用服务前查看。我们建议您在使用这些服务前仔细阅读其隐私政策。</p>

                <h3>儿童隐私保护</h3>
                <p>本平台不面向14岁以下儿童收集个人信息。如果您是家长且发现儿童未经您同意提供了个人信息，请联系我们删除。</p>
                <p>我们不会故意收集14岁以下儿童的个人信息。如果我们发现无意中收集了此类信息，我们将立即删除这些信息。</p>

                <h3>国际数据传输</h3>
                <p>由于使用GitHub服务，您的数据可能被传输到和存储在其他国家，包括美国。我们将确保适当的保护措施。</p>
                <p>您的信息可能会被传输到您所在国家/地区以外的服务器上进行存储和处理。</p>

                <h3>隐私政策更新</h3>
                <p>我们可能会不时更新本隐私政策：</p>
                <ul>
                    <li>重大变更将通过网站公告通知</li>
                    <li>更新后的政策将在此页面公布</li>
                    <li>继续使用平台即表示接受更新后的政策</li>
                    <li>建议定期查看以了解最新信息</li>
                </ul>
                <p>我们可能会不时更新本隐私政策。任何更改将在本页面上发布。</p>

                <h3>联系我们</h3>
                <p>如果您对本隐私政策有任何疑问或需要行使您的权利，请通过以下方式联系我们：</p>
                <ul>
                    <li><strong>GitHub</strong>：<a href="https://github.com/ziyi127" target="_blank" style="color: var(--mi-blue);">ziyi127</a></li>
                    <li><strong>项目地址</strong>：<a href="https://github.com/ziyi127/xiaomi-bl-petition" target="_blank" style="color: var(--mi-blue);">Xiaomi BL Petition</a></li>
                    <li><strong>邮箱</strong>：通过GitHub联系</li>
                </ul>
                <p>如果您对本隐私政策有任何疑问或需要进一步的信息，请通过上述联系方式与我们联系。</p>

                <h3>数据处理的法律依据</h3>
                <p>我们处理您数据的法律依据包括：</p>
                <ul>
                    <li><strong>合同履行</strong>：提供签名平台服务</li>
                    <li><strong>合法利益</strong>：维护平台安全和功能</li>
                    <li><strong>用户同意</strong>：您提交签名即表示同意</li>
                    <li><strong>法律义务</strong>：遵守相关法律法规</li>
                </ul>
                <p>我们处理您的数据是基于以下法律依据：</p>
                <ul>
                    <li>履行与您签订的合同（提供签名平台服务）</li>
                    <li>维护我们的合法利益（保护平台安全和功能）</li>
                    <li>您的明确同意（您提交签名即表示同意）</li>
                    <li>遵守法律义务（遵守相关法律法规）</li>
                </ul>

                <p style="margin-top: 2rem; font-style: italic; color: var(--text-secondary); border-top: 1px solid var(--glass-border); padding-top: 1rem;">
                    生效日期: 2025年7月29日<br>
                    最后更新: 2025年7月29日
                </p>
                <p style="margin-top: 1rem; font-style: italic; color: var(--text-secondary);">
                    本隐私政策的最终解释权归本项目所有。
                </p>
            </div>
        </div>
    </div>

    <script>
        // 全局变量
        let signatures = [];
        let signatureCount = 0;
        let supportDeviceCount = 0; // 支持设备总数
        let currentColor = '#000000';
        let isDrawing = false;
        let lastX = 0;
        let lastY = 0;
        let canvasCtx = null;
        let hasDrawn = false; // 添加绘制状态标记
        let supportDevices = []; // 支持的设备列表

        // 防刷限制相关变量
        const COOLDOWN_TIME = 300; // 5分钟冷却时间（秒）
        let lastSignatureTime = 0;
        
        // 缓存变量
        let signaturesCache = null;
        let lastSignatureTimeCache = null;

        // 安全的localStorage访问函数
        function safeLocalStorageGetItem(key, defaultValue = null) {
            try {
                const item = localStorage.getItem(key);
                return item !== null ? item : defaultValue;
            } catch (error) {
                console.warn(`获取localStorage项失败: ${key}`, error);
                return defaultValue;
            }
        }

        function safeLocalStorageSetItem(key, value) {
            try {
                localStorage.setItem(key, value);
                return true;
            } catch (error) {
                console.warn(`设置localStorage项失败: ${key}`, error);
                showSignatureMessage('存储失败，请清理浏览器缓存后重试', 'error');
                return false;
            }
        }

        function safeLocalStorageParse(key, defaultValue = []) {
            try {
                const item = safeLocalStorageGetItem(key);
                return item ? JSON.parse(item) : defaultValue;
            } catch (error) {
                console.warn(`解析localStorage项失败: ${key}`, error);
                return defaultValue;
            }
        }

        // 初始化签名数据
        function initSignatures() {
            signatures = safeLocalStorageParse('xiaomiSignatures', []);
            signatureCount = signatures.length;
            lastSignatureTime = parseInt(safeLocalStorageGetItem('lastSignatureTime', '0'));
        }

        // 从GitHub Issues获取签名数据
        async function fetchSignaturesFromGitHub() {
            try {
                const owner = 'ziyi127';
                const repo = 'xiaomi-bl-petition';
                
                // 获取所有带有signature标签的issues
                const response = await fetch(`https://api.github.com/repos/${owner}/${repo}/issues?labels=signature&state=open&per_page=100`, {
                    method: 'GET',
                    headers: {
                        'User-Agent': 'xiaomi-bl-petition',
                        'Authorization': 'token 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'
                    }
                });

                if (!response.ok) {
                    throw new Error(`GitHub API error: ${response.status} ${response.statusText}`);
                }

                const issues = await response.json();
                
                // 解析签名数据
                const githubSignatures = issues.map(issue => {
                    // 从issue body中提取签名信息
                    const body = issue.body || '';
                    
                    // 提取姓名
                    const nameMatch = body.match(/\*\*姓名\*\*:\s*(.*?)\n/);
                    const name = nameMatch ? nameMatch[1] : '匿名支持者';
                    
                    // 提取设备
                    const devicesMatch = body.match(/\*\*支持设备\*\*:\s*(.*?)\n/);
                    const devicesStr = devicesMatch ? devicesMatch[1] : '';
                    const devices = devicesStr ? devicesStr.split(',').map(d => d.trim()) : [];
                    
                    // 提取时间
                    const dateMatch = body.match(/\*\*签名时间\*\*:\s*(.*?)\n/);
                    const date = dateMatch ? dateMatch[1] : new Date(issue.created_at).toLocaleString('zh-CN');
                    
                    // 提取签名图片URL
                    const signatureMatch = body.match(/!\[签名图片\]\((.*?)\)/);
                    const signature = signatureMatch ? signatureMatch[1] : '';
                    
                    // 提取支持话语
                    // 调试：打印body内容以检查编码
                    console.log('Issue body:', body);
                    
                    // 尝试多种正则表达式模式
                    const patterns = [
                        /### 支持话语\s*([\s\S]*?)(?=\n#{3,}|\n---|$)/,
                        /###\s*支持话语\s*([\s\S]*?)(?=\n#{3,}|\n---|$)/,
                        /支持话语\s*([\s\S]*?)(?=\n#{3,}|\n---|$)/,
                        /### [\u4e00-\u9fa5]+\s*([\s\S]*?)(?=\n#{3,}|\n---|$)/
                    ];
                    
                    let supportMessageMatch = null;
                    let usedPattern = '';
                    
                    for (let i = 0; i < patterns.length; i++) {
                        supportMessageMatch = body.match(patterns[i]);
                        if (supportMessageMatch) {
                            usedPattern = patterns[i].toString();
                            break;
                        }
                    }
                    
                    const supportMessage = supportMessageMatch ? supportMessageMatch[1].trim() : '';
                    // 调试：打印匹配结果
                    console.log('Support message match:', supportMessageMatch);
                    console.log('Support message:', supportMessage);
                    console.log('Used pattern:', usedPattern);
                    
                    return {
                        id: issue.id,
                        name: name,
                        devices: devices,
                        date: date,
                        signature: signature,
                        supportMessage: supportMessage,
                        timestamp: new Date(issue.created_at).getTime()
                    };
                }).filter(signature => signature.signature); // 过滤掉没有签名的
                
                // 合并本地签名和GitHub签名，去重
                const allSignatures = [...signatures]; // 先添加本地签名
                
                githubSignatures.forEach(githubSignature => {
                    // 检查是否已存在（通过ID）
                    const exists = allSignatures.some(localSignature => localSignature.id === githubSignature.id);
                    if (!exists) {
                        allSignatures.push(githubSignature);
                    }
                });
                
                // 按时间排序（最新的在前）
                signatures = allSignatures.sort((a, b) => b.timestamp - a.timestamp);
                signatureCount = signatures.length;
                
                // 更新本地存储
                try {
                    localStorage.setItem('xiaomiSignatures', JSON.stringify(signatures));
                } catch (e) {
                    console.warn('无法更新本地存储:', e);
                }
                
                return true;
            } catch (error) {
                console.error('获取GitHub签名数据失败:', error);
                return false;
            }
        }

        // 分页相关变量
        const SIGNATURES_PER_PAGE = 64;
        let currentPage = 1;
        let totalPages = 1;

        // 初始化画布
        function initCanvas() {
            const canvas = document.getElementById('signatureCanvas');
            const container = canvas.parentElement;
            
            // 设置画布尺寸
            const rect = container.getBoundingClientRect();
            canvas.width = rect.width * window.devicePixelRatio;
            canvas.height = 150 * window.devicePixelRatio;
            
            // 设置CSS尺寸
            canvas.style.width = rect.width + 'px';
            canvas.style.height = '150px';
            
            const ctx = canvas.getContext('2d');
            
            // 设置高DPI渲染
            ctx.scale(window.devicePixelRatio, window.devicePixelRatio);
            
            // 设置画布样式
            ctx.strokeStyle = currentColor;
            ctx.lineWidth = 2 * window.devicePixelRatio;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width / window.devicePixelRatio, 150);
            
            canvasCtx = ctx;
            hasDrawn = false; // 重置绘制状态
            
            // 重新初始化键盘绘制位置
            const keyboardPositionInitialized = canvas.getAttribute('data-keyboard-init');
            if (keyboardPositionInitialized !== 'true') {
                // 设置一个属性标记键盘位置已初始化
                canvas.setAttribute('data-keyboard-init', 'true');
            }
            return ctx;
        }

        // 获取正确的鼠标/触摸坐标（解决偏移问题）
        function getEventPos(e, canvas) {
            const rect = canvas.getBoundingClientRect();
            let clientX, clientY;
            
            if (e.type.includes('touch')) {
                const touch = e.touches[0] || e.changedTouches[0];
                clientX = touch.clientX;
                clientY = touch.clientY;
            } else {
                clientX = e.clientX;
                clientY = e.clientY;
            }
            
            return {
                x: clientX - rect.left,
                y: clientY - rect.top
            };
        }

        // 绘制功能
        function startDrawing(e) {
            e.preventDefault();
            const canvas = document.getElementById('signatureCanvas');
            const pos = getEventPos(e, canvas);
            
            isDrawing = true;
            lastX = pos.x;
            lastY = pos.y;
            hasDrawn = true; // 标记已开始绘制
        }

        function draw(e) {
            if (!isDrawing) return;
            e.preventDefault();
            
            const canvas = document.getElementById('signatureCanvas');
            const ctx = canvasCtx;
            const pos = getEventPos(e, canvas);
            
            ctx.beginPath();
            ctx.moveTo(lastX, lastY);
            ctx.lineTo(pos.x, pos.y);
            ctx.stroke();
            
            lastX = pos.x;
            lastY = pos.y;
        }

        function stopDrawing() {
            isDrawing = false;
        }

        // 绑定事件
        function bindCanvasEvents() {
            const canvas = document.getElementById('signatureCanvas');
            
            // 鼠标事件
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);
            
            // 触摸事件
            canvas.addEventListener('touchstart', startDrawing, { passive: false });
            canvas.addEventListener('touchmove', draw, { passive: false });
            canvas.addEventListener('touchend', stopDrawing);
            
            // 防止页面滚动
            canvas.addEventListener('touchstart', function(e) {
                if (e.touches.length === 1) {
                    e.preventDefault();
                }
            }, { passive: false });
            
            // 键盘绘制事件
            setupKeyboardDrawing(canvas);
        }
        
        // 键盘绘制功能
        function setupKeyboardDrawing(canvas) {
            let isKeyboardDrawing = false;
            let keyboardX = 0;
            let keyboardY = 0;
            
            // 初始化键盘绘制位置
            function initKeyboardPosition() {
                keyboardX = canvas.width / (2 * window.devicePixelRatio);
                keyboardY = 75; // 垂直居中
            }
            
            // 绘制一个点
            function drawPoint() {
                if (!canvasCtx) return;
                
                canvasCtx.beginPath();
                canvasCtx.arc(keyboardX, keyboardY, 1 * window.devicePixelRatio, 0, 2 * Math.PI);
                canvasCtx.fill();
                hasDrawn = true;
            }
            
            // 绘制线条
            function drawLineTo(newX, newY) {
                if (!canvasCtx) return;
                
                canvasCtx.beginPath();
                canvasCtx.moveTo(keyboardX, keyboardY);
                canvasCtx.lineTo(newX, newY);
                canvasCtx.stroke();
                
                keyboardX = newX;
                keyboardY = newY;
                hasDrawn = true;
            }
            
            canvas.addEventListener('keydown', function(e) {
                // 只有当画布聚焦时才响应键盘事件
                if (document.activeElement !== canvas) return;
                
                let step = 5; // 移动步长
                let newX = keyboardX;
                let newY = keyboardY;
                let moved = false;
                
                switch(e.key) {
                    case 'ArrowUp':
                        newY = Math.max(0, keyboardY - step);
                        moved = true;
                        e.preventDefault();
                        break;
                    case 'ArrowDown':
                        newY = Math.min(150, keyboardY + step);
                        moved = true;
                        e.preventDefault();
                        break;
                    case 'ArrowLeft':
                        newX = Math.max(0, keyboardX - step);
                        moved = true;
                        e.preventDefault();
                        break;
                    case 'ArrowRight':
                        newX = Math.min(canvas.width / window.devicePixelRatio, keyboardX + step);
                        moved = true;
                        e.preventDefault();
                        break;
                    case ' ':
                        // 空格键开始/停止绘制
                        isKeyboardDrawing = !isKeyboardDrawing;
                        if (isKeyboardDrawing) {
                            drawPoint();
                        }
                        e.preventDefault();
                        break;
                }
                
                // 如果位置改变且正在绘制，则绘制线条
                if (moved) {
                    if (isKeyboardDrawing) {
                        drawLineTo(newX, newY);
                    } else {
                        keyboardX = newX;
                        keyboardY = newY;
                    }
                }
            });
            
            // 初始化键盘位置
            initKeyboardPosition();
        }

        // 颜色选择功能
        function setupColorPalette() {
            const colorOptions = document.querySelectorAll('.color-option');
            colorOptions.forEach(option => {
                option.addEventListener('click', function(e) {
                    e.preventDefault();
                    // 移除所有active类
                    colorOptions.forEach(opt => opt.classList.remove('active'));
                    // 添加当前active类
                    this.classList.add('active');
                    // 设置当前颜色
                    currentColor = this.getAttribute('data-color');
                    // 更新画布颜色
                    if (canvasCtx) {
                        canvasCtx.strokeStyle = currentColor;
                    }
                });
            });
        }

        // 清除签名
        function clearSignature() {
            const canvas = document.getElementById('signatureCanvas');
            const ctx = canvasCtx;
            if (ctx) {
                ctx.fillStyle = 'white';
                ctx.fillRect(0, 0, canvas.width / window.devicePixelRatio, 150);
                initCanvas();
            }
        }

        // 显示消息
        function showSignatureMessage(text, type) {
            const messageDiv = document.getElementById('signatureMessage');
            const icon = type === 'success' ? 'check-circle' : 
                        type === 'error' ? 'exclamation-circle' : 'info-circle';
            messageDiv.innerHTML = `<div class="message ${type}"><i class="fas fa-${icon}"></i> ${text}</div>`;
            setTimeout(() => {
                messageDiv.innerHTML = '';
            }, 5000);
        }

        // 检查冷却时间
        function checkCooldown() {
            const now = Math.floor(Date.now() / 1000);
            const timePassed = now - lastSignatureTime;
            const timeRemaining = COOLDOWN_TIME - timePassed;
            
            if (timeRemaining > 0) {
                return timeRemaining;
            }
            return 0;
        }

        // 显示冷却时间
        function showCooldownMessage(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            const timeText = minutes > 0 ? 
                `${minutes}分${remainingSeconds}秒` : 
                `${remainingSeconds}秒`;
                
            return `<div class="cooldown-message">
                <i class="fas fa-clock"></i> 请等待 <span class="cooldown-timer">${timeText}</span> 后再次签名
            </div>`;
        }

        // 设备管理功能
        function addDevice() {
            const deviceInput = document.getElementById('deviceName');
            const deviceName = deviceInput.value.trim();
            
            if (!deviceName) {
                showSignatureMessage('请输入设备名称', 'error');
                return;
            }
            
            // 检查是否为小米设备（简单检查）
            if (!deviceName.toLowerCase().includes('小米') && 
                !deviceName.toLowerCase().includes('mi') && 
                !deviceName.toLowerCase().includes('redmi') &&
                !deviceName.toLowerCase().includes('xiaomi')) {
                showSignatureMessage('请添加小米设备（包含"小米"、"Mi"、"Redmi"、"Xiaomi"）', 'error');
                return;
            }
            
            // 检查是否已添加
            if (supportDevices.includes(deviceName)) {
                showSignatureMessage('该设备已添加', 'error');
                return;
            }
            
            supportDevices.push(deviceName);
            updateDeviceList();
            deviceInput.value = '';
        }

        function removeDevice(index) {
            supportDevices.splice(index, 1);
            updateDeviceList();
        }

        function updateDeviceList() {
            const deviceList = document.getElementById('deviceList');
            
            if (supportDevices.length === 0) {
                deviceList.innerHTML = '<div style="text-align: center; color: var(--text-secondary); padding: 1rem;">请添加您支持的设备</div>';
                return;
            }
            
            let html = '';
            supportDevices.forEach((device, index) => {
                html += `
                    <div class="device-item" data-index="${index}">
                        <span class="device-name">${device}</span>
                        <button class="remove-device">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
            });
            
            deviceList.innerHTML = html;
        }

        // 更新统计数字
        function updateStats() {
            document.getElementById('signatureCount').textContent = signatureCount;
            
            // 计算支持设备总数（累加每个用户的设备）
            supportDeviceCount = 0;
            signatures.forEach(signature => {
                if (signature.devices && Array.isArray(signature.devices)) {
                    supportDeviceCount += signature.devices.length;
                }
            });
            document.getElementById('supportCount').textContent = supportDeviceCount;
            
            // 从2025年7月29日开始计算倡议天数
            const startDate = new Date('2025-07-29');
            const today = new Date();
            const daysDiff = Math.floor((today - startDate) / (1000 * 60 * 60 * 24));
            document.getElementById('daysCount').textContent = Math.max(0, daysDiff);
        }

        // 提交签名
        async function submitSignature() {
            const name = document.getElementById('name').value.trim();
            const email = document.getElementById('email').value.trim();
            const supportMessage = document.getElementById('supportMessage').value.trim();
            const devices = [...supportDevices]; // 复制设备列表

            // 检查冷却时间
            const cooldownRemaining = checkCooldown();
            if (cooldownRemaining > 0) {
                showSignatureMessage('请勿频繁提交', 'error');
                return;
            }

            if (!name) {
                showSignatureMessage('请输入您的姓名', 'error');
                return;
            }

            if (devices.length === 0) {
                showSignatureMessage('请至少添加一个支持的设备', 'error');
                return;
            }

            // 检查是否已绘制签名
            if (!hasDrawn) {
                showSignatureMessage('请绘制您的电子签名', 'error');
                return;
            }

            // 检查是否有签名内容
            const canvas = document.getElementById('signatureCanvas');
            const ctx = canvasCtx;
            if (!ctx) {
                showSignatureMessage('签名板初始化失败，请刷新页面重试', 'error');
                return;
            }

            // 检查是否有绘制内容（更准确的检测）
            const imageData = ctx.getImageData(0, 0, canvas.width / window.devicePixelRatio, 150);
            let hasDrawing = false;
            // 检查是否有非白色像素（除了边框）
            for (let i = 3; i < imageData.data.length; i += 4) {
                const r = imageData.data[i];
                const g = imageData.data[i + 1];
                const b = imageData.data[i + 2];
                const a = imageData.data[i + 3];
                // 如果不是纯白色，则认为有绘制内容
                if (r !== 255 || g !== 255 || b !== 255 || a !== 255) {
                    hasDrawing = true;
                    break;
                }
            }

            if (!hasDrawing) {
                showSignatureMessage('请绘制您的电子签名', 'error');
                return;
            }

            try {
                showSignatureMessage('正在提交签名...', 'info');
                
                // 获取签名数据
                const signatureDataUrl = canvas.toDataURL('image/png');
                
                // 创建新签名对象
                const newSignature = {
                    id: Date.now(),
                    name: name,
                    email: email,
                    devices: devices,
                    date: new Date().toLocaleString('zh-CN'),
                    signature: signatureDataUrl,
                    supportMessage: supportMessage,
                    timestamp: Date.now()
                };

                // 准备GitHub Issue数据
                const issueData = {
                    title: `【签名支持】${name} 支持小米BL解锁`,
                    body: `## 签名信息\n\n- **姓名**: ${name}\n- **邮箱**: ${email || '未提供'}\n- **支持设备**: ${devices.join(', ')}\n- **签名时间**: ${new Date().toLocaleString('zh-CN')}\n- **签名ID**: ${Date.now()}\n\n---\n\n### 支持话语\n\n${supportMessage || '未提供支持话语'}\n\n---\n\n### 签名图片\n\n![签名图片](${signatureDataUrl})\n\n---\n\n> 此签名通过网页提交，支持小米BL解锁 petition 活动。`,
                    labels: ['signature', 'petition']
                };

                // GitHub仓库信息
                const owner = 'ziyi127';
                const repo = 'xiaomi-bl-petition';
                
                // 直接访问GitHub Issues API
                const response = await fetch(`https://api.github.com/repos/${owner}/${repo}/issues`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'token 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',
                        'User-Agent': 'xiaomi-bl-petition'
                    },
                    body: JSON.stringify(issueData)
                });

                if (!response.ok) {
                    const errorText = await response.text();
                    console.error('GitHub API 错误详情:', errorText);
                    throw new Error(`GitHub API error: ${response.status} ${response.statusText} - ${errorText}`);
                }

                // 添加到本地数组开头（用于页面显示）
                signatures.unshift(newSignature);
                signatureCount = signatures.length;
                
                // 记录签名时间（用于冷却）
                const now = Math.floor(Date.now() / 1000);
                safeLocalStorageSetItem('lastSignatureTime', now.toString());
                lastSignatureTime = now;
                
                // 清空设备列表
                supportDevices = [];
                
                // 更新UI
                updateStats();
                clearForm();
                
                showSignatureMessage('签名提交成功！感谢您的支持！', 'success');
                
                // 3秒后自动关闭模态框
                setTimeout(() => {
                    closeSignatureModal();
                }, 3000);
                
            } catch (error) {
                showSignatureMessage('提交失败，请稍后重试', 'error');
                console.error('提交错误:', error);
            }
        }

        // 清除表单
        function clearForm() {
            document.getElementById('name').value = '';
            document.getElementById('email').value = '';
            document.getElementById('deviceName').value = '';
            supportDevices = [];
            updateDeviceList();
            clearSignature();
            hasDrawn = false; // 重置绘制状态
        }

        // 分页功能
        function getTotalPages() {
            return Math.ceil(signatures.length / SIGNATURES_PER_PAGE);
        }

        function getCurrentPageSignatures() {
            const startIndex = (currentPage - 1) * SIGNATURES_PER_PAGE;
            const endIndex = startIndex + SIGNATURES_PER_PAGE;
            return signatures.slice(startIndex, endIndex);
        }

        // 加载签名列表到页面
        async function loadSignaturesToPage() {
            const container = document.getElementById('signaturesPageContainer');
            
            if (signatures.length === 0) {
                container.innerHTML = `
                    <div class="glass-effect" style="grid-column: 1 / -1; text-align: center; padding: 2rem;">
                        <i class="fas fa-users" style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5; color: var(--mi-orange);"></i>
                        <p style="font-size: 0.9rem;">暂无签名，成为第一个支持者吧！</p>
                    </div>
                `;
                return;
            }

            const currentSignatures = getCurrentPageSignatures();
            let html = '';
            
            currentSignatures.forEach(signature => {
                // 生成设备标签
                let devicesHtml = '';
                if (signature.devices && signature.devices.length > 0) {
                    signature.devices.forEach(device => {
                        devicesHtml += `<span class="device-tag">${device}</span>`;
                    });
                }
                
                // 截取支持话语的前100个字符作为预览
                const supportMessagePreview = signature.supportMessage ? 
                    (signature.supportMessage.length > 100 ? 
                        signature.supportMessage.substring(0, 100) + '...' : 
                        signature.supportMessage) : 
                    '未提供支持话语';
                
                html += `
                    <div class="signature-card glass-effect animate-fade-in" onclick="openSignatureDetailModal(${JSON.stringify(signature).replace(/"/g, '&quot;')})">
                        <div class="signature-name">
                            <i class="fas fa-user mi-orange-accent"></i> ${signature.name}
                        </div>
                        <div class="signature-date">
                            <i class="far fa-clock"></i> ${signature.date}
                        </div>
                        ${signature.devices && signature.devices.length > 0 ? `
                        <div class="signature-devices">
                            <i class="fas fa-mobile-alt"></i> 支持设备: ${devicesHtml}
                        </div>
                        ` : ''}
                        <div class="signature-support-message">
                            <i class="fas fa-comment"></i> ${supportMessagePreview}
                        </div>
                        <img src="${signature.signature}" alt="签名" class="signature-image" onerror="this.style.display='none'">
                    </div>
                `;
            });
            
            container.innerHTML = html;

            // 更新分页控件
            updatePagination();
        }

        // 更新分页控件
        function updatePagination() {
            const totalPages = getTotalPages();
            const prevBtn = document.getElementById('prevPage');
            const nextBtn = document.getElementById('nextPage');
            const pageInfo = document.getElementById('pageInfo');

            // 更新按钮状态
            prevBtn.disabled = currentPage <= 1;
            nextBtn.disabled = currentPage >= totalPages;

            // 更新页面信息
            pageInfo.textContent = `第 ${currentPage} 页，共 ${Math.max(1, totalPages)} 页`;
        }

        // 页面导航
        async function goToPage(page) {
            const totalPages = getTotalPages();
            if (page >= 1 && page <= totalPages) {
                currentPage = page;
                await loadSignaturesToPage();
            }
        }

        // 模态框控制函数
        function openSignatureModal() {
            const modal = document.getElementById('signatureModal');
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
            initCanvas();
            
            // 焦点管理：将焦点移到模态框内
            const firstFocusableElement = modal.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
            if (firstFocusableElement) {
                firstFocusableElement.focus();
            }
            
            // 键盘导航支持：限制焦点在模态框内
            setupModalFocusTrap(modal);
            
            // 检查冷却时间
            const cooldownRemaining = checkCooldown();
            if (cooldownRemaining > 0) {
                // 不显示冷却提示，只在提交时提示
            }
        }

        function closeSignatureModal() {
            const modal = document.getElementById('signatureModal');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
            clearForm();
            
            // 焦点管理：将焦点返回到打开模态框的按钮
            const openModalButton = document.getElementById('openSignatureModal');
            if (openModalButton) {
                openModalButton.focus();
            }
        }

        // 页面切换函数
        function showHomePage() {
            document.getElementById('homePage').style.display = 'block';
            document.getElementById('signaturesPage').style.display = 'none';
            document.body.style.overflow = 'auto';
            
            // 将焦点移到页面主要内容
            const mainContent = document.querySelector('.hero');
            if (mainContent) {
                mainContent.focus();
            }
        }

        async function showSignaturesPage() {
            document.getElementById('homePage').style.display = 'none';
            document.getElementById('signaturesPage').style.display = 'block';
            document.body.style.overflow = 'auto';
            
            // 从GitHub获取最新签名数据
            await fetchSignaturesFromGitHub();
            
            currentPage = 1;
            await loadSignaturesToPage();
            
            // 将焦点移到页面主要内容
            const mainContent = document.querySelector('.signatures-container');
            if (mainContent) {
                mainContent.focus();
            }
        }

        // 移动端导航菜单
        function setupMobileMenu() {
            const navToggle = document.getElementById('navToggle');
            const mobileMenu = document.getElementById('mobileMenu');
            
            navToggle.addEventListener('click', function() {
                mobileMenu.classList.toggle('active');
                const icon = this.querySelector('i');
                if (mobileMenu.classList.contains('active')) {
                    icon.className = 'fas fa-times';
                    navToggle.setAttribute('aria-expanded', 'true');
                    
                    // 将焦点移到菜单内的第一个元素
                    const firstMenuItem = mobileMenu.querySelector('a');
                    if (firstMenuItem) {
                        firstMenuItem.focus();
                    }
                } else {
                    icon.className = 'fas fa-bars';
                    navToggle.setAttribute('aria-expanded', 'false');
                }
            });

            // 点击菜单项后关闭菜单
            document.querySelectorAll('.mobile-menu a').forEach(link => {
                link.addEventListener('click', function() {
                    mobileMenu.classList.remove('active');
                    document.getElementById('navToggle').querySelector('i').className = 'fas fa-bars';
                    navToggle.setAttribute('aria-expanded', 'false');
                    
                    // 将焦点返回到菜单切换按钮
                    navToggle.focus();
                });
            });
            
            // 键盘支持：ESC键关闭菜单
            mobileMenu.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    mobileMenu.classList.remove('active');
                    document.getElementById('navToggle').querySelector('i').className = 'fas fa-bars';
                    navToggle.setAttribute('aria-expanded', 'false');
                    navToggle.focus();
                }
            });
        }

        // 防抖函数
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // 模态框焦点陷阱
        function setupModalFocusTrap(modal) {
            const focusableElements = modal.querySelectorAll(
                'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
            );
            const firstFocusableElement = focusableElements[0];
            const lastFocusableElement = focusableElements[focusableElements.length - 1];

            const trapTabKey = function(e) {
                if (e.key !== 'Tab') return;

                if (e.shiftKey) {
                    if (document.activeElement === firstFocusableElement) {
                        lastFocusableElement.focus();
                        e.preventDefault();
                    }
                } else {
                    if (document.activeElement === lastFocusableElement) {
                        firstFocusableElement.focus();
                        e.preventDefault();
                    }
                }
            };

            modal.addEventListener('keydown', trapTabKey);
        }

        // 窗口大小改变时重新初始化画布
        function handleResize() {
            if (document.getElementById('signatureModal').style.display === 'block') {
                initCanvas();
            }
        }
        
        // 颜色选择器功能
        function setupColorPalette() {
            const colorOptions = document.querySelectorAll('.color-option');
            
            colorOptions.forEach(option => {
                // 点击选择颜色
                option.addEventListener('click', function() {
                    // 移除所有选项的active类和aria-checked属性
                    colorOptions.forEach(opt => {
                        opt.classList.remove('active');
                        opt.setAttribute('aria-checked', 'false');
                    });
                    
                    // 为当前选项添加active类和aria-checked属性
                    this.classList.add('active');
                    this.setAttribute('aria-checked', 'true');
                    
                    // 设置当前颜色
                    currentColor = this.getAttribute('data-color');
                });
                
                // 键盘导航支持
                option.addEventListener('keydown', function(e) {
                    let currentIndex = Array.from(colorOptions).indexOf(this);
                    
                    switch(e.key) {
                        case 'ArrowLeft':
                            e.preventDefault();
                            if (currentIndex > 0) {
                                colorOptions[currentIndex - 1].focus();
                            }
                            break;
                        case 'ArrowRight':
                            e.preventDefault();
                            if (currentIndex < colorOptions.length - 1) {
                                colorOptions[currentIndex + 1].focus();
                            }
                            break;
                        case 'Home':
                            e.preventDefault();
                            colorOptions[0].focus();
                            break;
                        case 'End':
                            e.preventDefault();
                            colorOptions[colorOptions.length - 1].focus();
                            break;
                        case ' ':
                        case 'Enter':
                            e.preventDefault();
                            this.click();
                            break;
                    }
                });
            });
        }

        // 支持话语详情模态框功能
        function openSignatureDetailModal(signature) {
            const modal = document.getElementById('supportMessageModal');
            const content = document.getElementById('supportMessageContent');
            const title = document.getElementById('supportMessageModalTitle');
            
            // 设置标题
            title.textContent = `来自 ${signature.name} 的支持话语`;
            
            // 设置内容
            content.textContent = signature.supportMessage || '未提供支持话语';
            
            // 显示模态框
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // 焦点管理
            const firstFocusableElement = modal.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
            if (firstFocusableElement) {
                firstFocusableElement.focus();
            }
            
            // 键盘导航支持
            setupModalFocusTrap(modal);
        }
        
        function closeSupportMessageModal() {
            const modal = document.getElementById('supportMessageModal');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }
        
        // 隐私政策模态框功能
        function setupPrivacyModal() {
            const modal = document.getElementById("privacyModal");
            const btn = document.getElementById("privacyPolicyLink");
            const closeBtn = document.getElementById("closePrivacyModal");

            // 点击链接打开模态框
            btn.onclick = function(e) {
                e.preventDefault();
                modal.style.display = "block";
                document.body.style.overflow = "hidden";
                
                // 焦点管理：将焦点移到模态框内
                const firstFocusableElement = modal.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
                if (firstFocusableElement) {
                    firstFocusableElement.focus();
                }
                
                // 键盘导航支持：限制焦点在模态框内
                setupModalFocusTrap(modal);
            }

            // 点击关闭按钮关闭模态框
            closeBtn.onclick = function() {
                modal.style.display = "none";
                document.body.style.overflow = "auto";
                // 焦点管理：将焦点返回到打开模态框的链接
                if (btn) {
                    btn.focus();
                }
            }

            // 点击模态框外部关闭
            window.onclick = function(event) {
                if (event.target == modal) {
                    modal.style.display = "none";
                    document.body.style.overflow = "auto";
                    // 焦点管理：将焦点返回到打开模态框的链接
                    if (btn) {
                        btn.focus();
                    }
                }
            }

            // ESC键关闭
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape') {
                    // 检查支持话语模态框是否打开
                    if (supportMessageModal && supportMessageModal.classList.contains('active')) {
                        closeSupportMessageModal();
                    }
                    // 检查隐私政策模态框是否打开
                    else if (modal.style.display === "block") {
                        modal.style.display = "none";
                        document.body.style.overflow = "auto";
                        // 焦点管理：将焦点返回到打开模态框的链接
                        if (btn) {
                            btn.focus();
                        }
                    }
                }
            });
            
            // 支持话语详情模态框事件监听器
            const supportMessageModal = document.getElementById('supportMessageModal');
            const closeSupportMessageBtn = document.getElementById('closeSupportMessageModal');
            
            if (closeSupportMessageBtn) {
                closeSupportMessageBtn.addEventListener('click', closeSupportMessageModal);
            }
            
            // 点击模态框外部关闭
            if (supportMessageModal) {
                supportMessageModal.addEventListener('click', function(event) {
                    if (event.target == supportMessageModal) {
                        closeSupportMessageModal();
                    }
                });
            }
        }

        // 初始化
        async function init() {
            // 初始化签名数据
            initSignatures();
            
            // 从GitHub获取签名数据
            await fetchSignaturesFromGitHub();
            
            // 初始化事件监听器
            document.getElementById('openSignatureModal').addEventListener('click', openSignatureModal);
            document.getElementById('closeSignatureModal').addEventListener('click', closeSignatureModal);
            document.getElementById('clearSignatureBtn').addEventListener('click', clearSignature);
            document.getElementById('submitSignatureBtn').addEventListener('click', submitSignature);
            document.getElementById('viewSignaturesBtn').addEventListener('click', showSignaturesPage);
            document.getElementById('backToHome').addEventListener('click', showHomePage);
            document.getElementById('addDeviceBtn').addEventListener('click', addDevice);
            document.getElementById('deviceName').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    addDevice();
                }
            });
            
            // 调试按钮事件监听器已移除
            
            document.getElementById('homeLink').addEventListener('click', function(e) {
                e.preventDefault();
                showHomePage();
            });
            document.getElementById('signaturesLink').addEventListener('click', function(e) {
                e.preventDefault();
                showSignaturesPage();
            });
            document.getElementById('mobileHomeLink').addEventListener('click', function(e) {
                e.preventDefault();
                showHomePage();
                // 关闭移动端菜单
                document.getElementById('mobileMenu').classList.remove('active');
                document.getElementById('navToggle').querySelector('i').className = 'fas fa-bars';
            });
            document.getElementById('mobileSignaturesLink').addEventListener('click', function(e) {
                e.preventDefault();
                showSignaturesPage();
                // 关闭移动端菜单
                document.getElementById('mobileMenu').classList.remove('active');
                document.getElementById('navToggle').querySelector('i').className = 'fas fa-bars';
            });

            // 分页按钮事件
            document.getElementById('prevPage').addEventListener('click', function() {
                goToPage(currentPage - 1);
            });
            document.getElementById('nextPage').addEventListener('click', function() {
                goToPage(currentPage + 1);
            });

            // 初始化画布事件
            bindCanvasEvents();
            setupColorPalette();
            setupMobileMenu();
            setupPrivacyModal();
            
            // 为设备列表添加事件委托
            document.getElementById('deviceList').addEventListener('click', function(e) {
                if (e.target.closest('.remove-device')) {
                    const deviceItem = e.target.closest('.device-item');
                    const index = parseInt(deviceItem.dataset.index);
                    removeDevice(index);
                }
            });
            
            // 更新统计数据
            updateStats();
            loadSignaturesToPage();
            
            // 添加滚动动画
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, { threshold: 0.1 });

            document.querySelectorAll('.animate-fade-in').forEach(el => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(20px)';
                el.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
                observer.observe(el);
            });

            // 导航栏滚动效果（防抖）
            const debouncedScroll = debounce(function() {
                const navbar = document.querySelector('.navbar');
                if (window.scrollY > 30) {
                    navbar.style.background = 'rgba(255, 255, 255, 0.3)';
                } else {
                    navbar.style.background = 'rgba(255, 255, 255, 0.3)';
                }
            }, 100);

            window.addEventListener('scroll', debouncedScroll);

            // 窗口大小改变事件（防抖）
            const debouncedResize = debounce(handleResize, 250);
            window.addEventListener('resize', debouncedResize);

            // 点击模态框外部关闭
            document.getElementById('signatureModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeSignatureModal();
                }
            });

            // ESC键关闭模态框
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape') {
                    if (document.getElementById('signatureModal').style.display === 'block') {
                        closeSignatureModal();
                    }
                    if (document.getElementById('privacyModal').style.display === 'block') {
                        document.getElementById('privacyModal').style.display = 'none';
                        document.body.style.overflow = 'auto';
                    }
                }
            });
        }

        // 页面加载完成后初始化
        window.addEventListener('load', init);
        
        // 确保在DOMContentLoaded时也初始化
        document.addEventListener('DOMContentLoaded', init);
        
        // 全局函数供HTML调用
        window.removeDevice = removeDevice;
    </script>
</body>
</html>

